(in-package #:cl)

(defpackage #:conflog-gui
  (:use #:clim-lisp #:clim #:conflog))

(in-package #:conflog-gui)

;;; Compiler Utils
(eval-when (:compile-toplevel :load-toplevel :execute)
  (defun generate-id/label (name)
    (if (listp name)
	`(:id ',(first name) :label ,(second name))
	`(:id ',name :label ,(symbol-name name))))

  (defmacro t/nil<->on/off (thing)
    (ecase thing
      ((t) ''on)
      ((nil) ''off)
      ((on) t)
      ((off) nil)))

  (defun default-callback (&rest args)
    (declare (ignore args))
    nil)
  
  (defun symb (&rest args)
    (intern (format nil "窿狎珞┅┅换蔑铈祜蝈玳篝弪ㄥ鲠飙麒孱ê泔眇殪瀛麸痨弼屐红镝洵麸痨弼屐哄邈豸濠ㄤ彐鲠痱邃铋飑ㄤ彐鲠殇玑溏弭磲脲栳箬翎忪濠ㄤ彐磲泸泔铈祜绛蝈玳篝ㄧ徜珏轭轸篝狒躞怙澌怙澌啜痱镧箦舡轭轸篝狒躞ㄧ徜珏舡殇玑溏弭轭轸篝狒躞箦舡篝狒躞ㄧ徜珏舡殇玑溏弭轭轸篝狒躞箦翩ㄧ弭栳箬ㄧ徜珏舡殇玑溏弭殇玑溏弭玑溏弭蝈玳篝ㄧ徜珏舡殇玑溏弭灬礅溽ㄩ痱弼篝狒躞篝狒躞ㄤ邈灬蝈ㄩ珙矧徕戾殇痱弼篝狒躞篝狒躞┅棱镤┅玑溏弭┅ㄤ彐躅泔铈祜绛蝈玳篝铒篝狒躞ㄧ徜珏舂ㄣ镱骒镧蝈玳篝玑溏弭ㄧ孱簌愆┅ㄤ彐躅箦舡镱镦ㄧ徜珏篝狒躞箦翩ㄧ徜珏舡鲠祯玑溏弭ㄣ狍篝狒躞è镱舂è镦姗铋飑┅ㄤ彐躅泔铈祜绛蝈玳篝镱镦姝篝狒躞ㄧ徜珏轭轸篝狒躞箦舡镱镦玑溏弭轭轸篝狒躞ㄣ镱骒镧蝈玳篝玑溏弭轭轸篝狒躞箦舡镱镦玑溏弭篝狒躞┅ㄤ彐躅箦舡箦戾泗轱铙ㄧ徜珏篝狒躞麒孱篝狒躞ㄩㄡ麸篝狒躞戾èㄧ弭栳箬篝狒躞殇玑溏弭铋飑┅麒孱箦翩ㄧ徜珏舡鲠祯玑溏弭绌┅箦翩ㄧ徜珏舡鲠祯玑溏弭蝈盹鲥殒＇铛祆磲疸狎灬礅溽ㄩ洎ㄧ弭栳箬殇殇玑溏弭铋飑篝狒躞┅┅┅ㄤ彐躅泔铈祜绛蝈玳篝箦戾泗轱瞽篝狒躞ㄧ徜珏轭轸篝狒躞箦舡箦戾泗轱铙玑溏弭轭轸篝狒躞ㄣ镱骒镧蝈玳篝玑溏弭轭轸篝狒躞箦舡箦戾泗轱铙玑溏弭篝狒躞┅ㄤ彐躅箦舡蜥铉ㄧ徜珏篝狒躞麒孱铛礅弪篝狒躞箦翩ㄧ徜珏舡鲠祯玑溏弭篝狒躞┅ㄤ彐躅泔铈祜绛蝈玳篝蜥铉瀛篝狒躞ㄧ徜珏轭轸篝狒躞箦舡蜥铉玑溏弭轭轸篝狒躞ㄣ镱骒镧蝈玳篝玑溏弭轭轸篝狒躞箦舡蜥铉玑溏弭篝狒躞┅ㄤ彐躅箦舡篝蜷铉ㄧ徜珏篝狒躞麒孱篝蜷铉篝狒躞箦翩ㄧ徜珏舡鲠祯玑溏弭篝狒躞┅ㄤ彐躅泔铈祜绛蝈玳篝翦舡篝狒躞ㄧ徜珏轭轸篝狒躞箦舡篝蜷铉玑溏弭轭轸篝狒躞ㄣ镱骒镧蝈玳篝玑溏弭轭轸篝狒躞箦舡篝蜷铉玑溏弭篝狒躞┅ㄤ彐躅泔铈祜绛蝈玳篝泔礅锃篝狒躞ㄧ徜珏轭轸篝狒躞箦翩ㄧ徜珏舡鲠祯玑溏弭轭轸篝狒躞ㄣ镱骒镧蝈玳篝玑溏弭轭轸篝狒躞箦翩ㄧ徜珏舡鲠祯玑溏弭篝狒躞┅ㄤ彐躅泔铈祜绛蝈骝弩璀犰ī祜镳骘殇忮轭遽汨栳箬脲轭殇玑溏弭躞轭ㄨ狍璀鲠祯玑溏弭滹痱镧蝈骝弩璀篝狒躞蝈箫祧殇┅┅ㄤ彐磲泸泔铈祜绛珏瞽痱镬镧蹂蝓戾ī啜痱镧括祜镳骘痱邃轭蝈鲥蝮痱邃泔祆邈啜涵ì痱邃况犰蹂矧ㄞ簌礅痱邃М鲠祯濠ㄞ簌礅痱邃М篝狒躞┅ì簌礅痱邃М鲠祯濠况犰蹂ì簌礅痱邃М篝狒躞矿翎趱螬矧ㄡ钿浇矿翎趱溟筢忪濠箬秣痱邃镱ㄥ钺忪痱邃镦姗矧ㄡ钿浇矿翎趱栝溴箬秣痱邃镦姗ㄡ钿箬秣痱邃镱ㄥ钺忪痱邃镱┅┅┅┅ㄤ彐磲泸泔铈祜绛珏瞽屦殪镧蹂蝓戾ī啜痱镧括祜镳骘痱邃轭蝈鲥蝮痱邃狃疱钿啜êì簌礅痱邃М鲠祯濠况犰蹂ì痱邃况犰蹂┅êì簌礅痱邃М篝狒躞矿翎趱螬矧ㄡ钿箬秣痱邃匡骀浇匡骀镦姗矿翎趱栝溴┅矧ㄡ钿ㄥ钺忪痱邃匡骀浇匡骀镦姗矿翎趱溟筢忪濠矿翎趱镱┅┅┅┅ㄤ彐磲泸泔铈祜绛珏瞽麸珑戾箦戾泗轱铙扉铍徵瀛蝓戾ī啜痱镧括祜镳骘痱邃轭蝈鲥蝮痱邃犷玑溏弭ㄧ弭栳箬痱邃殇玑溏弭铋飑麒孱ㄡ钿玑溏弭矧豉疱玑溏弭蜥溟锃怙豉疱玑溏弭с桢汶怙┅狃疱钿戾è怙殇ㄧ徜珏舡殇玑溏弭┅ㄣ桢汶殇磲疸狎＇玑溏弭殇箬邋舡汨殪潋孱玑溏弭┅┅ㄩ豉疱玑溏弭蜥溟锃怙祜镳骘汨邈氕殇轭汨邈氕殇狃疱钿啜êì怙殇汨邈氕殇ㄞ汨邈氕殇ì汨邈氕殇镱┅êì汨邈氕殇镱ㄞ怙殇ì怙殇汨邈氕殇┅êì汨邈氕殇镦姗ㄞ怙殇┅┅ㄡ痧孱啜êì怙殇款鬻括磲疸犷灬礅溽ㄣ桢汶殇啜ㄞ汨邈氕殇ì汨邈氕殇咯┅汨邈氕殇螬ㄩ款鬻箫螋蝈盹鲥殒＇铛祆磲疸狎灬礅溽ㄣ桢汶殇麒孱ㄧ徜珏舡鲠祯ㄧ弭栳箬汨邈氕殇殇玑溏弭┅汨邈氕殇┅К汨邈氕殇螬＇篝蜷铉缉┅祜镳骘汨邈氕殇轭汨邈氕殇狃疱钿啜êì汨邈氕殇镱ㄞ怙殇ì怙殇裤桢汶螬礤礅弪汨邈氕殇裤桢汶螬êì汨邈氕殇镦姗ㄞ怙殇┅┅┅┅┅ㄤ彐磲泸泔铈祜绛珏瞽泔眇孱筢翦蝓戾ī啜痱镧括狃疱钿祜镳骘痱邃轭蝈鲥蝮蝈盹鲥漉痨殂狒弩磲疸狎＇骈蝮泔铈祜绾邯桢徜┅泔祆邈啜涵ì痱邃况犰蹂篝狒躞痱邃况犰蹂┅祜镳骘痱邃轭蝈鲥蝮痱邃躅戾篌礤礅弪痱邃磲疸狎＇骈蝮泔铈祜绾邯桢徜┅泔祆邈啜涵ì痱邃况犰蹂篝狒躞痱邃况犰蹂┅祜镳骘痱邃轭蝈鲥蝮痱邃狃疱钿啜êì簌礅痱邃М鲠祯濠况犰蹂篝狒躞簌礅痱邃М鲠祯濠况犰蹂┅êì簌礅痱邃М篝狒躞矿翎趱螬篝狒躞簌礅痱邃М篝狒躞矿翎趱螬┅┅┅换蔑铈祜绛驽狒躜邃渺轫轻溏弭ㄤ彐磲泸磲脲怩趑镱è钺礤脲ㄣ犰焘徙＇溴驷蹯舡汜祆忉汶┅蝈篝疳铄镳糸镱螬瘐箬铄钺礤痱邃啜泔铈祜绛蝈玳篝铒篝狒躞磲脲疳铄ю躞璀怩趑镱括珏铄蜥翦殇灬忮钺礤横泗轹狒瀛汜祆忉汶灬礅溽ㄧ徜珏舂箦舡篝狒躞蝈箫祧ㄧ徜珏舡殇玑溏弭ㄧ孱簌愆ㄦ躅汜祆汜祆忉汶玑溏弭┅鲤犷瀛镳糸镱螬┅ㄤ彐磲泸磲脲箦戾泗轱豉疱钺礤脲ㄣ犰焘徙＇溴驷蹯舡汜祆忉汶ㄩ铋舡篝狒躞铋飑箦戾泗轱铙蝈篝疳铄镳糸镱螬瘐箬铄钺礤痱邃祜镳骘箦戾泗轱轭箦戾泗轱铙滹瘐箬铄ㄩㄡ麸箦戾泗轱瞟箦戾泗轱ㄦ轵篝箦戾泗轱瞟痱邃┅啜戾舄è汨镩沐扉篝括磲疸狎灬礅溽箦戾泗轱瞟啜泔铈祜绛蝈玳篝镱镦姝篝狒躞磲脲疳铄麸珑戾怩趑镱括珏铄蜥翦殇灬忮箦戾泗轱瞟洪钿殂狒矧豉疱ㄩㄥ豉疱蜥溟锃怙猴铄镦后镯瀛镦忽犰蹂汨犷珏洵汜祆忉汶灬礅溽ㄧ徜珏鲠祯濠箦舡篝狒躞蝈箫祧ㄧ徜珏舡殇玑溏弭ㄩ鲠祯ээ骀┅┅э骀┅箦戾泗轱铙┅ㄣ躜蝈铘ㄩㄥ豉疱蜥溟锃怙啜矧ㄧ弭栳箬К轭轸篝狒躞殇玑溏弭铋飑ㄦ轵篝汨镩沐螬麒孱轭轸篝狒躞啜蝈盹鲥殒＇铛祆磲疸狎灬礅溽螬ㄧ弭栳箬殇玑溏弭铋飑К轭轸篝狒躞┅┅┅ㄣ镱骒镧蝈玳篝箦戾泗轱瞽篝狒躞磲脲疳铄К豉疱括珏铄蜥翦殇灬忮钺礤恒栾殂弩汨镩沐后屐邈糸镱沲蝌孱忽犰蹂汨犷珏洵汜祆忉汶灬礅溽ㄧ徜珏鲠祯濠箦舡篝狒躞蝈箫祧ㄧ徜珏舡殇玑溏弭ㄩㄥ豉疱蜥溟锃怙啜玑溏弭殇鲠祯濠啜箫螋磲疸狎＇玑溏弭殇鲠祯濠＇篝蜷铉缉┅ㄦ躅汜祆汜祆忉汶玑溏弭鲠祯濠鲤犷瀛镳糸镱螬ㄩㄥ豉疱蜥溟锃怙啜矧К轭轸篝狒躞ㄧ徜珏舡殇沲蝌孱舂唰轭轸篝狒躞┅┅ㄤ彐磲泸磲脲蜥溟镡秫é蝈篝狎珞啜磲脲箦戾泗轱蜥溟锃怙泪蜱螬ㄤ彐磲泸磲脲汨邈脞秫é蝈篝狎珞啜磲脲箦戾泗轱汨邈氕怙泪蜱螬ㄤ彐磲泸磲脲箪殇弪è钺礤脲ㄣ犰焘徙＇溴驷蹯舡汜祆忉汶ㄩ铋舡篝狒躞癌黹癌磲卑癌蝈篝疳铄镳糸镱螬瘐箬铄钺礤痱邃啜泔铈祜绛蝈玳篝蜥铉瀛篝狒躞磲脲疳铄箪殇弪洪К钺礤喉轭鲠祯黹喉狲鲠祯磲忽犰蹂黹侯蹴忮颦镦聃犷翎磲猴蜷孱翎糸镱鸿矧辁镱翎忽犰蹂汨犷珏洵汜祆忉汶灬礅溽ㄧ徜珏鲠祯濠箦舡篝狒躞蝈箫祧ㄧ徜珏舡殇玑溏弭鲠祯濠ㄦ躅汜祆汜祆忉汶玑溏弭鲠祯濠鲤犷瀛镳糸镱螬轭轸篝狒躞┅ㄤ彐磲泸磲脲邃轸怙è钺礤脲ㄣ犰焘徙＇溴驷蹯舡汜祆忉汶ㄩ铋舡篝狒躞┅蝈篝疳铄镳糸镱螬瘐箬铄钺礤痱邃啜泔铈祜绛蝈玳篝翦舡篝狒躞磲脲疳铄翦舡骈屐洪К钺礤忽犰蹂汨犷珏洵汜祆忉汶灬礅溽ㄧ徜珏鲠祯濠箦舡篝狒躞蝈箫祧ㄧ徜珏舡殇玑溏弭鲠祯濠ㄦ躅汜祆汜祆忉汶玑溏弭鲠祯濠鲤犷瀛镳糸镱螬轭轸篝狒躞┅ㄤ彐磲泸磲脲泔礅è钺礤脲ㄣ犰焘徙＇溴驷蹯舡汜祆忉汶ㄩ铋舡篝狒躞铋飑箦戾泗轱铙蝈篝疳铄镳糸镱螬瘐箬铄钺礤痱邃啜泔铈祜绛蝈玳篝泔礅锃篝狒躞磲脲疳铄э痿轱瞽疳铄洪К钺礤洪翦眢К箦戾泗轱铙忽犰蹂轭轸篝狒躞忽犰蹂汨犷珏洵汜祆忉汶灬礅溽ㄧ徜珏鲠祯濠箦舡篝狒躞蝈箫祧ㄧ徜珏舡殇玑溏弭鲠祯濠ㄦ躅汜祆汜祆忉汶玑溏弭鲠祯濠┅轭轸篝狒躞┅换拈犰镧ㄤ彐鲠溟犰镧铋飑ㄤ彐磲泸磲脲溟犰镧钺礤é蝈篝泔铘蝻飙扉篝é蝈篝泔铘蝻飙灬秕舂蝈篝泔铈祜绛蝓戾螬戾è泔铈祜绛溴怩ㄧ孱簌愆┅ㄤ邈灬蝈ㄩ珙矧徕戾泔铈祜绛溴怩绌啜痱镧ㄤ彐轭瀛狃痨殂狒轱瞽骝犴钺礤īīê疳铄＋泔铈祜绛溴怩ì泔铈祜绛溴怩横痧扉汜糸镱瑚殇翳赴后泸镬飙忉蝮衡雉瑭楞镱趄镬扉篝ê灬秕趔ㄤ彐狨祠＋泔铈祜绛溴怩ㄨ矧辁镱翎祆īū泔铘蝻飙灬秕舂ǔ灬忮祆轭ê灬忮⒚镱骒镧田纰┈泔铈祜绛溴怩绌┅－泔铈祜绛溴怩泔铘蝻飙灬秕舂┅痱镧箦翩溟犰镧磲脲轭篝犷沐К钺礤┅ㄣ戾狎蝓戾螬ㄣ戾狎篝狒躞ㄣ镱骒镧珏瞽痱镬镧蹂蝓戾螬ㄣ镱骒镧珏瞽麸珑戾箦戾泗轱铙扉铍徵瀛蝓戾螬楞镱骒镧蝓戾ㄣ镱骒镧珏瞽屦殪镧蹂蝓戾螬ㄣ镱骒镧珏瞽泔眇孱筢翦蝓戾螬┅┅ㄤ彐躅蝓瞽溟犰镧ㄤ獒祜蝈篝镳糸镱螬ㄣ扉憝簌蠛磲脲痱镢弩＇灬礅溽īㄡ痧禊＇蝓瞽骝犴瀛麸瓠戾鲥溟犰镧镳糸镱螬侯犴ㄦ矧磲铋立ㄦ蜥礤钺礤溟犰镧┅祜镳躅糸铒ㄥㄦ蜥礤篝狒溟犰镧轰轶秣铄洎┅ㄣ镱骒镧蝈骝弩璀犰飑溟犰镧换痱轫轸轹弩骘珲镳弪狒轱ㄣ镱骒镧汉溴骈铄痱轫轸轹孱徕戾痱邃篝狒躞泔铘戾èㄧ弭栳箬痱邃殇玑溏弭铋飑┅麒孱ㄩㄣ镱骒镧汉躅怙躅洵鲠颦篝狒躞ㄣ镱骒镧汉躅殒篝狒躞ㄩㄧ徜珏舡徙糸鲥绌ээ骀┅ㄣ狍ㄩ铘弪簌礅镬钺礤ㄣ镱骒镧汉溴蝈篝狒躞┅弘妁黠蜾ê镦ㄤ遽泗轹狒瀛玑溏弭绌ê镱ㄡ泗轹狒瀛玑溏弭绌┅┅ㄦ躅汜祆泔铘┅ㄣ镱骒镧汉溴骈铄痱轫轸轹箬秣痱邃篝狒躞泔铘戾èㄧ弭栳箬痱邃殇玑溏弭铋飑┅麒孱ㄩㄣ镱骒镧汉躅怙躅洵鲠颦篝狒躞ㄣ镱骒镧汉躅殒篝狒躞ㄩㄧ徜珏舡徙糸鲥绌ээ骀┅ㄣ狍ㄩ铘弪簌礅镬钺礤ㄣ镱骒镧汉溴蝈篝狒躞┅弘妁黠蜾ê镱箦翩箬邋舡孱徕戾洵绌舂ê镦箦翩箬邋舡孱徕戾洵绌铋飑┅┅ㄦ躅汜祆泔铘┅ㄣ镱骒镧汉溴骈铄痱轫轸轹孱徕戾屐屙孱舣痱邃祗篝狒躞祗泔铘磲疸灬礅溽痱邃篝狒躞ㄥ钺忪瀵痱邃篝狒躞灬礅溽ī舂┅痱邃祗篝狒躞祗舂ㄦ躅汜祆泔铘┅ㄣ镱骒镧汉溴骈铄痱轫轸轹箬秣屐屙孱舣痱邃祗篝狒躞祗泔铘磲疸灬礅溽痱邃篝狒躞箬秣痱邃篝狒躞灬礅溽ī舂┅痱邃祗篝狒躞祗舂ㄦ躅汜祆泔铘┅ㄣ镱骒镧汉溴骈铄痱轫轸轹礤篌徵瀵糸綮翦篝戾泔铘铒糸纟躞弪溟犰镧ㄦ矧磲铋岛辋窿甸翦舂呼轸戾糸綮后豉戾篝戾ㄦ躅汜祆泔铘┅ㄣ镱骒镧汉溴骈铄痱轫轸轹礤篌徵瀵糸綮翦泔铘礤篌徵瀵⑸铈铫翦洪铈矧泔铘┅ㄣ镱骒镧汉溴骈铄痱轫轸轹礤篌徵瀵翦泔铘礤篌徵瀵⑸铈铫翦洪铈矧泔铘┅ㄣ镱骒镧汉溴骈铄痱轫轸轹轭骘蝽翦泔铘礤篌徵瀵⑸铈铫翦洪铈矧泔铘┅ㄣ镱骒镧汉溴骈铄痱轫轸轹麽蝾轭绡翦泔铘礤篌徵瀵⒆狎铋铉翦瑚狎铋铉泔铘┅ㄣ镱骒镧汉溴骈铄痱轫轸轹弪蝻虔翦泔铘礤篌徵瀵⑴蝌矧翦哄蝌矧泔铘┅